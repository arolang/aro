# Skip integration test due to TTY detection changes

# FormatAwareIO creates files in ./output
# Clean up from previous test runs
pre-script: rm -rf output

# Verify all generated files exist and have correct format
# Checks: 1) All 12 files exist 2) Each file has correct format using regex patterns
test-script: test -d output && test -f output/config.env && test -f output/config.txt && test -f output/users.csv && test -f output/users.html && test -f output/users.json && test -f output/users.jsonl && test -f output/users.md && test -f output/users.sql && test -f output/users.toml && test -f output/users.tsv && test -f output/users.xml && test -f output/users.yaml && grep -q '^APP_NAME=FormatAwareIO' output/config.env && grep -q '^DATABASE_HOST=localhost' output/config.env && grep -q '^DATABASE_PORT=5432' output/config.env && grep -q '^CACHE_ENABLED=true' output/config.env && grep -q '^debug=true' output/config.txt && grep -q '^host=localhost' output/config.txt && grep -q '^port=8080' output/config.txt && grep -q '^email,id,name' output/users.csv && grep -q 'alice@example.com,1,Alice' output/users.csv && grep -q '<table>' output/users.html && grep -q '<thead>' output/users.html && grep -q '<tbody>' output/users.html && grep -q '<tr><th>email</th>' output/users.html && grep -E '^\[$' output/users.json && grep -q '"email"' output/users.json && grep -q '"id"' output/users.json && grep -q '{"email":"alice@example.com","id":1,"name":"Alice"}' output/users.jsonl && grep -q '| email | id | name |' output/users.md && grep -E '\|---\|---\|---\|' output/users.md && grep -q '| alice@example.com | 1 | Alice |' output/users.md && grep -q "INSERT INTO users (email, id, name) VALUES" output/users.sql && grep -q '^\[\[users\]\]' output/users.toml && grep -q 'email = "alice@example.com"' output/users.toml && head -1 output/users.tsv | grep -E 'email.*id.*name' && grep -E 'alice@example.com.*1.*Alice' output/users.tsv && grep -q '<?xml version="1.0" encoding="UTF-8"?>' output/users.xml && grep -q '<users>' output/users.xml && grep -q '<item>' output/users.xml && grep -q '<email>alice@example.com</email>' output/users.xml && grep -q '^- email: alice@example.com' output/users.yaml && grep -q '  id: 1' output/users.yaml && grep -q '  name: Alice' output/users.yaml
