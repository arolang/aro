<!DOCTYPE html>
<html lang="en">
<head>
    <title>Concurrency - ARO Programming Language</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="../../animations.css">
    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u="//matomo.benjamin.ausdertechnik.de/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '4']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->

    <style>
        .doc-page {
            padding: 120px 24px 80px;
            max-width: 800px;
            margin: 0 auto;
        }

        .doc-page h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 24px;
            letter-spacing: -0.02em;
        }

        .doc-page h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin: 48px 0 16px;
            padding-top: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .doc-page h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 32px 0 12px;
            color: var(--color-secondary);
        }

        .doc-page h4 {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 24px 0 10px;
            color: var(--color-text);
        }

        .doc-page p {
            font-size: 1.1rem;
            color: var(--color-text-muted);
            line-height: 1.8;
            margin-bottom: 16px;
        }

        .doc-page code {
            font-family: var(--font-mono);
            background: var(--color-bg-alt);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .doc-page pre {
            background: var(--color-bg-alt);
            border-radius: var(--radius-md);
            padding: 20px;
            overflow-x: auto;
            margin: 24px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .doc-page pre code {
            background: none;
            padding: 0;
            font-size: 0.9rem;
            line-height: 1.7;
        }

        .doc-page ul, .doc-page ol {
            color: var(--color-text-muted);
            margin: 16px 0 16px 24px;
            line-height: 1.8;
        }

        .doc-page li {
            margin-bottom: 8px;
        }

        .doc-page table {
            width: 100%;
            border-collapse: collapse;
            margin: 24px 0;
        }

        .doc-page th, .doc-page td {
            padding: 12px 16px;
            text-align: left;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .doc-page th {
            background: var(--color-bg-alt);
            font-weight: 600;
        }

        .doc-page blockquote {
            border-left: 4px solid var(--color-primary);
            padding-left: 20px;
            margin: 24px 0;
            color: var(--color-text);
            font-style: italic;
        }

        .doc-page strong {
            color: var(--color-text);
        }

        .doc-page em {
            color: var(--color-secondary);
        }

        .doc-page a {
            color: var(--color-primary);
            text-decoration: none;
        }

        .doc-page a:hover {
            text-decoration: underline;
        }

        .doc-page hr {
            border: none;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin: 48px 0;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--color-text-muted);
            text-decoration: none;
            font-size: 0.95rem;
            margin-bottom: 24px;
            transition: color 0.2s;
        }

        .back-link:hover {
            color: var(--color-primary);
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-content">
            <a href="/aro/" class="logo">
                <span class="logo-aro">ARO</span>
            </a>
            <div class="nav-links">
                <a href="../../fdd.html">The FDD Story</a>
                <a href="../../getting-started.html">Get Started</a>
                <a href="../../tutorial.html">Tutorial</a>
                <a href="../../docs.html" style="color: var(--color-text);">Docs</a>
                <a href="../../disclaimer.html">Motivation</a>
                <a href="https://github.com/KrisSimon/aro" class="nav-github">GitHub</a>
            </div>
        </div>
    </nav>

    <main class="doc-page animate-on-scroll">
        <a href="../../docs.html" class="back-link">&#x2190; Back to Documentation</a>
        <h1>Concurrency</h1>
<p>ARO&#39;s concurrency model is radically simple: <strong>feature sets are async, statements are sync</strong>. This chapter explains how ARO handles concurrent operations without requiring you to think about threads, locks, or async/await.</p>
<h2>The Philosophy</h2>
<p>ARO&#39;s concurrency model matches how project managers think:</p>
<ul>
<li><strong>&quot;When X happens, do Y&quot;</strong> — Feature sets are triggered by events</li>
<li><strong>&quot;Do this, then this, then this&quot;</strong> — Steps happen in order</li>
</ul>
<p>You don&#39;t think about threads, locks, race conditions, or async/await. You think about things happening and responding to them in sequence.</p>
<h2>Feature Sets Are Async</h2>
<p>Every feature set runs asynchronously when triggered by an event:</p>
<pre><code>┌─────────────────────────────────────────────────────┐
│                    Event Bus                         │
│                                                      │
│  HTTP Request ──┬──► (listUsers: User API)          │
│                 │                                    │
│  Socket Data ───┼──► (Handle Data: Socket Handler)  │
│                 │                                    │
│  File Changed ──┼──► (Process File: File Handler)   │
│                 │                                    │
│  UserCreated ───┴──► (Send Email: Notification)     │
│                                                      │
│  (Multiple events trigger multiple feature sets     │
│   running concurrently)                              │
└─────────────────────────────────────────────────────┘
</code></pre>
<p>When multiple events arrive, multiple feature sets execute simultaneously. 100 HTTP requests = 100 concurrent feature set executions.</p>
<h2>Statements Are Sync</h2>
<p>Inside a feature set, statements execute <strong>synchronously</strong> and <strong>serially</strong>:</p>
<pre><code class="language-aro">(Process Order: Order API) {
    &lt;Extract&gt; the &lt;data&gt; from the &lt;request: body&gt;.      (* 1. First *)
    &lt;Validate&gt; the &lt;data&gt; for the &lt;order-schema&gt;.       (* 2. Second *)
    &lt;Create&gt; the &lt;order&gt; with &lt;data&gt;.                   (* 3. Third *)
    &lt;Store&gt; the &lt;order&gt; in the &lt;order-repository&gt;.      (* 4. Fourth *)
    &lt;Emit&gt; to &lt;Send Confirmation&gt; with &lt;order&gt;.         (* 5. Fifth *)
    &lt;Return&gt; a &lt;Created: status&gt; with &lt;order&gt;.          (* 6. Last *)
}
</code></pre>
<p>Each statement completes before the next one starts. No callbacks. No promises. No async/await syntax. Just sequential execution.</p>
<h2>Why This Model?</h2>
<h3>Simplicity</h3>
<p>Traditional async code in JavaScript:</p>
<pre><code class="language-javascript">async function processOrder(req) {
    const data = await extractData(req);
    const validated = await validate(data);
    const order = await createOrder(validated);
    await storeOrder(order);
    await emitEvent(&#39;OrderCreated&#39;, order);
    return { status: 201, body: order };
}
</code></pre>
<p>ARO code:</p>
<pre><code class="language-aro">(Process Order: Order API) {
    &lt;Extract&gt; the &lt;data&gt; from the &lt;request: body&gt;.
    &lt;Validate&gt; the &lt;data&gt; for the &lt;order-schema&gt;.
    &lt;Create&gt; the &lt;order&gt; with &lt;data&gt;.
    &lt;Store&gt; the &lt;order&gt; in the &lt;order-repository&gt;.
    &lt;Emit&gt; to &lt;Send Confirmation&gt; with &lt;order&gt;.
    &lt;Return&gt; a &lt;Created: status&gt; with &lt;order&gt;.
}
</code></pre>
<p>No <code>async</code>. No <code>await</code>. Just statements in order.</p>
<h3>No Race Conditions</h3>
<p>Within a feature set, there&#39;s no shared mutable state problem:</p>
<ul>
<li>Variables are scoped to the feature set</li>
<li>Statements execute serially</li>
<li>No concurrent access to the same data</li>
</ul>
<h3>Natural Event Flow</h3>
<p>Events naturally express concurrency:</p>
<ul>
<li>User A requests an order while User B requests their profile</li>
<li>Both feature sets run concurrently</li>
<li>Each processes their own data independently</li>
</ul>
<h2>Runtime Optimization</h2>
<p>While you write synchronous-looking code, the ARO runtime executes operations <strong>asynchronously</strong> based on data dependencies. This is transparent to you.</p>
<h3>How It Works</h3>
<p>The runtime performs <strong>data-flow driven execution</strong>:</p>
<ol>
<li><strong>Eager Start</strong>: I/O operations begin immediately (non-blocking)</li>
<li><strong>Dependency Tracking</strong>: The runtime tracks which variables each statement needs</li>
<li><strong>Lazy Synchronization</strong>: Only wait for data when it&#39;s actually used</li>
<li><strong>Preserved Semantics</strong>: Results appear in statement order</li>
</ol>
<h3>Example</h3>
<pre><code class="language-aro">(Process Config: File Handler) {
    &lt;Open&gt; the &lt;config-file&gt; from the &lt;path&gt;.        (* 1. Starts file load *)
    &lt;Compute&gt; the &lt;hash&gt; for the &lt;request&gt;.          (* 2. Runs immediately *)
    &lt;Log&gt; the &lt;status&gt; for the &lt;request&gt;.            (* 3. Runs immediately *)
    &lt;Parse&gt; the &lt;config&gt; from the &lt;config-file&gt;.     (* 4. Waits for file *)
    &lt;Return&gt; an &lt;OK: status&gt; with &lt;config&gt;.
}
</code></pre>
<p><strong>What happens:</strong></p>
<ul>
<li>Statement 1 kicks off file loading (async, returns immediately)</li>
<li>Statements 2 and 3 execute while the file loads in background</li>
<li>Statement 4 waits only if the file isn&#39;t ready yet</li>
<li>You see: synchronous execution</li>
<li>Runtime does: parallel I/O with sequential semantics</li>
</ul>
<p><strong>Write synchronous code. Get async performance.</strong></p>
<h2>Event Emission</h2>
<p>Feature sets can trigger other feature sets:</p>
<pre><code class="language-aro">(Create User: User API) {
    &lt;Extract&gt; the &lt;data&gt; from the &lt;request: body&gt;.
    &lt;Create&gt; the &lt;user&gt; with &lt;data&gt;.
    &lt;Store&gt; the &lt;user&gt; in the &lt;user-repository&gt;.

    (* Triggers other feature sets asynchronously *)
    &lt;Emit&gt; to &lt;Send Welcome Email&gt; with &lt;user&gt;.

    (* Continues immediately, doesn&#39;t wait for handler *)
    &lt;Return&gt; a &lt;Created: status&gt; with &lt;user&gt;.
}

(Send Welcome Email: Notifications) {
    &lt;Extract&gt; the &lt;email&gt; from the &lt;event: email&gt;.
    &lt;Send&gt; the &lt;welcome-email&gt; to the &lt;email&gt;.
    &lt;Return&gt; an &lt;OK: status&gt;.
}
</code></pre>
<p>When <code>&lt;Emit&gt;</code> executes:</p>
<ol>
<li>The event is dispatched to the target feature set</li>
<li>Execution continues in the current feature set</li>
<li>The target handler starts executing independently</li>
</ol>
<h2>No Concurrency Primitives</h2>
<p>ARO explicitly does <strong>not</strong> provide:</p>
<ul>
<li><code>async</code> / <code>await</code> keywords</li>
<li>Promises / Futures</li>
<li>Threads / Task spawning</li>
<li>Locks / Mutexes / Semaphores</li>
<li>Channels</li>
<li>Actors</li>
<li>Parallel for loops</li>
</ul>
<p>These are implementation concerns. The runtime handles them. You write sequential code that responds to events.</p>
<h2>Examples</h2>
<h3>HTTP Server</h3>
<pre><code class="language-aro">(Application-Start: My API) {
    &lt;Start&gt; the &lt;http-server&gt; on port 8080.
    &lt;Keepalive&gt; the &lt;application&gt; for the &lt;events&gt;.
    &lt;Return&gt; an &lt;OK: status&gt;.
}

(* Each request triggers this independently *)
(getUser: User API) {
    &lt;Extract&gt; the &lt;id&gt; from the &lt;pathParameters: id&gt;.
    &lt;Retrieve&gt; the &lt;user&gt; from the &lt;user-repository&gt; where id = &lt;id&gt;.
    &lt;Return&gt; an &lt;OK: status&gt; with &lt;user&gt;.
}
</code></pre>
<h3>Socket Echo Server</h3>
<pre><code class="language-aro">(Application-Start: Echo Server) {
    &lt;Start&gt; the &lt;socket-server&gt; on port 9000.
    &lt;Keepalive&gt; the &lt;application&gt; for the &lt;events&gt;.
    &lt;Return&gt; an &lt;OK: status&gt;.
}

(* Each client message triggers this independently *)
(Handle Data: Socket Event Handler) {
    &lt;Extract&gt; the &lt;data&gt; from the &lt;event: data&gt;.
    &lt;Extract&gt; the &lt;connection&gt; from the &lt;event: connection&gt;.
    &lt;Send&gt; the &lt;data&gt; to the &lt;connection&gt;.
    &lt;Return&gt; an &lt;OK: status&gt;.
}
</code></pre>
<h3>File Watcher</h3>
<pre><code class="language-aro">(Application-Start: File Watcher) {
    &lt;Watch&gt; the &lt;directory&gt; for the &lt;changes&gt; with &quot;./watched&quot;.
    &lt;Keepalive&gt; the &lt;application&gt; for the &lt;events&gt;.
    &lt;Return&gt; an &lt;OK: status&gt;.
}

(* Each file change triggers this independently *)
(Handle File Change: File Event Handler) {
    &lt;Extract&gt; the &lt;path&gt; from the &lt;event: path&gt;.
    &lt;Extract&gt; the &lt;type&gt; from the &lt;event: type&gt;.
    &lt;Log&gt; the &lt;change: message&gt; with &lt;path&gt; and &lt;type&gt;.
    &lt;Return&gt; an &lt;OK: status&gt;.
}
</code></pre>
<h2>Summary</h2>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Behavior</th>
</tr>
</thead>
<tbody><tr>
<td>Feature sets</td>
<td>Run async (triggered by events)</td>
</tr>
<tr>
<td>Statements</td>
<td>Appear sync (serial execution)</td>
</tr>
<tr>
<td>I/O operations</td>
<td>Async under the hood</td>
</tr>
<tr>
<td>Events</td>
<td>Non-blocking dispatch</td>
</tr>
<tr>
<td>Concurrency primitives</td>
<td>None needed</td>
</tr>
</tbody></table>
<p>Write synchronous code. Get async performance. No callbacks, no promises, no await.</p>

    </main>

    <!-- Progress Bar -->
    <div class="progress-bar" id="progressBar"></div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <span class="logo-aro">ARO</span>
                    <p>The ARO Programming Language</p>
                    <p class="footer-tagline">Speak Business. Write Code.</p>
                </div>
                <div class="footer-links">
                    <div class="footer-col">
                        <h4>Learn</h4>
                        <a href="../../getting-started.html">Getting Started</a>
                        <a href="../../tutorial.html">Tutorial</a>
                        <a href="../../docs.html">Documentation</a>
                        <a href="../../fdd.html">FDD History</a>
                    </div>
                    <div class="footer-col">
                        <h4>Community</h4>
                        <a href="https://github.com/KrisSimon/aro">GitHub</a>
                        <a href="https://github.com/KrisSimon/aro/issues">Issues</a>
                        <a href="../../disclaimer.html">Motivation & Disclaimer</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Sometime this page should build with ARO. Obviously.</p>
            </div>
        </div>
    </footer>

    <!-- Animation Scripts -->
    <script src="../../animations.js"></script>

</body>
</html>
